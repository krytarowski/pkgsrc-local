$NetBSD$

--- Oops.rej.orig	2016-09-27 01:14:48.138391349 +0000
+++ Oops.rej
@@ -1,17 +1,40 @@
-@@ -13,6 +13,7 @@
- #include <stdlib.h>
- #include <string.h>
- #include <ctype.h>
-+#include <unistd.h>
- #include <string>
- #include <map>
- #ifndef __hpux
-@@ -62,7 +63,7 @@
- char *G__calc(char*);
- char *G__getexpr(char*);
- char *G__getandor(char*);
--#if !defined(__hpux) && !defined(__APPLE__) 
-+#if !defined(__hpux) && !defined(__APPLE__) && !defined(__NetBSD__) && !defined(__FreeBSD__) && !defined(__OpenBSD__) && !defined(__DragonFly__)
- char getopt(int argc,char **argv,char *optlist);
- #endif
- extern int optind;
+@@ -2575,7 +2575,7 @@
+ {
+ 	char temp[ONELINE],temp1[ONELINE];
+ 	FILE *fopen();
+-	int fp;
++	long fp;
+ 
+ 	if(strcmp(funcname,"printf")==0) {
+ 		/* para[0]:description, para[1~paran-1]: */
+@@ -2596,18 +2596,18 @@
+ 
+ 	if(strcmp(funcname,"fclose")==0) {
+ 		/* para[0]:filepointer */
+-		sprintf(result7,"%d",fclose((FILE*)atoi(libp->para[0])));
++		sprintf(result7,"%d",fclose((FILE*)atol(libp->para[0])));
+ 		return(1);
+ 	}
+ 
+ 	if(strcmp(funcname,"fgets")==0) {
+ 		/* parameter[0]:varname, para[1]:nchar,para[2]:filepointer */
+-		fp=atoi(libp->para[2]);
++		fp=atol(libp->para[2]);
+ 		sprintf(result7,"%ld"
+ 			,(long)fgets(temp,atoi(libp->para[1]),(FILE*)fp));
+ 		G__letvariable(libp->parameter[0]
+ 			    ,G__add_quotation(temp),&G__global,G__local);
+-		sprintf(temp,"%d",fp);
++		sprintf(temp,"%ld",fp);
+ 		G__letvariable(libp->parameter[1],temp,&G__global,G__local);
+ 		return(1);
+ 	}
+@@ -2615,7 +2615,7 @@
+ 	if(strcmp(funcname,"fprintf")==0) {
+ 		/* parameter[0]:pointer ,parameter[1]:description, para[2~paran-1]: */
+ 		G__charformatter(result7,1,libp);
+-		fprintf((FILE*)atoi(libp->para[0]),"%s",result7);
++		fprintf((FILE*)atol(libp->para[0]),"%s",result7);
+ 		strcpy(result7,"");
+ 		return(1);
+ 	}
